import{b as e,a as t,R as n}from"./index-80ae32d7.js";import{L as a,n as r}from"./index-b337307e.js";import"./defineProperty-a0480c32.js";import{_ as o}from"./slicedToArray-e1941acd.js";import"./toConsumableArray-0ed5356c.js";import{checkBalance as c}from"./common-27892a1c.js";import{a as u}from"./api-17772ac6.js";import{t as l}from"./actionTypes-edbc1405.js";import{u as i}from"./index-f0f0d0e2.js";import"./extends-cc4fca12.js";import{_ as m}from"./objectWithoutProperties-234758e1.js";import{P as s}from"./Pager-96b949a7.js";import{D as p}from"./Dialog-550d8283.js";import{H as d,L as f,N as y,T as E,A}from"./index-307e5487.js";import{E as b}from"./Icons-5efe7a19.js";import{A as h}from"./Animate-9feb1866.js";import{f as T,a as _,A as S,h as N}from"./index-0d44c75a.js";var j=i(function(e){return{balance:e.balance,session:e.session,payeeAccounts:e.payeeAccounts}})(function(i){var j=i.dispatch,v=m(i,["dispatch"]),C=e(""),g=o(C,2),k=g[0],q=g[1],x=e(!1),R=o(x,2),w=R[0],B=R[1],D=e(!1),I=o(D,2),O=I[0],P=I[1],H=e([]),F=o(H,2),M=F[0],U=F[1],V=T(v.balance.balance,"request"===v.option?"credit":"debit"),L=o(V,2),z=L[0],G=L[1],Z=function(e){q(e),B(!1),P(!0)},W=function(e){var t=new FormData(document.querySelector("form")),n=t.get("amount");return t.append("contact",e.account),t.append("processorType",e.account_processor),t.append("method",e.account_type),Number(n)?j({type:l.SET_AUTHORIZE_AND_TRANSACTION,payload:{transaction:{proceed:function(){return Y(t)}},authorize:{status:!0,proceed:function(){return Y(t)}}}}):S("Enter amount!")},Y=function(e){return document.querySelector("input[name=password]")&&e.append("password",document.querySelector("input[name=password]").value),P(!1),j({type:l.SET_AUTHORIZE,payload:{status:!1}}),j({type:l.SET_BUTTON,payload:!0}),_(u.sendMoney,e).then(function(t){if("bank"===e.get("method")&&t){if(t.resp.reference_id)return j({type:l.SET_REFERENCE_AND_TRANSACTION,payload:{reference:t,transaction:{redirect:"/pay"}}}),r("/authorize/bank/".concat(t.resp.reference_id))}else if(t&&"completed"===t.status)return j({type:l.SET_TRANSACTION,payload:{status:!0,amount:e.get("amount"),contact:e.get("contact"),note:"Transfer Complete",redirect:"/pay"}})})};return t(function(){var e=new FormData;e.append("payee_uid",v.uid),_(u.getBalance).then(function(e){return j({type:l.SET_BALANCE,payload:e})}).then(function(){return _(u.getPayeeAccounts,e).then(function(e){return j({type:l.SET_PAYEE_ACCOUNTS,payload:e})})})},[]),t(function(){for(var e=[],t=v.payeeAccounts,n=0;n<t.length;n++){var a=t[n].account_type;k===a?e.push(t[n]):k===a&&e.push(t[n])}U(e)},[k,v.payeeAccounts]),n.createElement(n.Fragment,null,n.createElement(s,null,n.createElement("div",{className:"header",style:{paddingBottom:"0px"}},n.createElement(a,{to:"/pay"},n.createElement(b,null)),n.createElement("h6",null,"Â¢",z+" "," ",n.createElement("span",null,"Bal"))),n.createElement("div",null,n.createElement("form",{onSubmit:function(e){return e.preventDefault()}},d({name:"payee",defaultValue:v.payee}),d({name:"method",defaultValue:k}),n.createElement(f,{id:"amount"},y({name:"amount",onChange:function(e){return G(e.target.value)},defaultValue:"0.00"}),"GHS"),n.createElement(f,null,E({name:"note",placeholder:"Message for ".concat(v.payee),style:{margin:"0px"},defaultValue:""})),n.createElement("h5",null),n.createElement(f,null,"request"===v.option?n.createElement("a",{onClick:function(){return function(){var e=document.querySelector("input[name=amount]").value;if(!Number(e))return S("Enter amount!");var t="GHS".concat(e," - ").concat(document.querySelector("input[name=note]").value),n="https://hitriva.me/".concat(v.session.username);N("Request Payment",t,n,function(){return r("/pay")})}()}},n.createElement(A,null,v.option)):n.createElement("a",{onClick:function(){return e=document.querySelector("input[name=amount]").value,Number(e)?c(e,v.balance.balance)?B(!0):S("Insufficient Balance"):S("Enter amount!");var e}},n.createElement(A,{default:!0},v.option)))))),w?n.createElement(p,{onClick:B},n.createElement(h,{onClick:function(){return Z("momo")}},n.createElement("li",null,"Mobile Money")),n.createElement(h,{onClick:function(){return Z("bank")}},n.createElement("li",null,"Bank"))):"",O?n.createElement(p,{onClick:P},n.createElement(h,{onClick:function(){r("/pay?tab=pay&payee=".concat(v.payee,"&uid=").concat(v.uid,"&option=").concat(k,"#/payee/add")),P(!1)}},n.createElement("li",{className:"new"},"New ",k)),function(e){return e.map(function(e,t){return n.createElement(h,{key:e.uid,onClick:function(){return W(e)}},n.createElement("li",null,e.account),n.createElement("span",null,e.account_processor))})}(M)):"")});export default j;
