import{a as e,R as t,b as a}from"./index-80ae32d7.js";import{L as n,n as l}from"./index-b337307e.js";import"./defineProperty-a0480c32.js";import{_ as r}from"./slicedToArray-e1941acd.js";import{_ as c}from"./toConsumableArray-0ed5356c.js";import{resizeImage as u,getFormData as o}from"./common-27892a1c.js";import{a as m}from"./api-17772ac6.js";import{t as i}from"./actionTypes-edbc1405.js";import{u as s}from"./index-f0f0d0e2.js";import"./extends-cc4fca12.js";import{_ as d}from"./objectWithoutProperties-234758e1.js";import{P as E}from"./Pager-96b949a7.js";import{D as p}from"./Dialog-550d8283.js";import{H as f,L as g,N as v,B as h,F as y,T as N,A as b}from"./index-307e5487.js";import{B as S,A as w,C as D,M as A,P as G,S as C,c as T,d as k}from"./Icons-5efe7a19.js";import{A as F}from"./Animate-9feb1866.js";import{a as _,b as j,_ as L,g as V,e as U,f as x,A as O}from"./index-0d44c75a.js";import W from"./PagerRouter-1bb02afb.js";import{M}from"./Menu-52e8819c.js";var R=s(function(e){return{summary:e.summary}})(function(a){var l=a.summary,r=a.dispatch;return e(function(){_(m.getSummary).then(function(e){return r({type:i.SET_SUMMARY,payload:e})})},[]),t.createElement(E,{classname:"summary"},t.createElement("div",{className:"header"},t.createElement(n,{to:"/goals",className:"exit"},"Close"),t.createElement("h5",null,"Goals ",t.createElement("br",null),"Summary")),t.createElement("div",null,t.createElement("div",{className:"divider"},t.createElement("div",null,t.createElement("h4",null,"¢",j(l.sum)||0),t.createElement("span",null,"Saved")),t.createElement("hr",{className:"middle"}),t.createElement("div",null,t.createElement("h4",null,l.total||0),t.createElement("span",null,"Goals"))),t.createElement("div",{className:"breakdown"},t.createElement("section",null,t.createElement("div",null,t.createElement("h4",null,l.completed||0),t.createElement("span",null,"Completed")),"/",t.createElement("div",null,t.createElement("h5",null,"¢",l.completed_sum||0))),t.createElement("section",null,t.createElement("div",null,t.createElement("h4",null,l.pending||0),t.createElement("span",null,"Pending")),"/",t.createElement("div",null,t.createElement("h5",null,"¢",l.pending_sum||0))))))}),I=function(){var c=a(0),u=r(c,2),o=u[0],m=u[1],i=a(0),s=r(i,2),d=s[0],y=s[1],N=a(0),b=r(N,2),A=b[0],G=b[1],C=a(!1),T=r(C,2),k=T[0],_=T[1],j=a("Day"),x=r(j,2),O=x[0],W=x[1],M=a(),R=r(M,2),I=R[0],q=R[1],B=U(),P=B.currentDate,H=B.getDateNMonth,z=function(){var e=L(V.mark(function e(){var t,a;return V.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Number(Number(o/d).toFixed(0)),a=P,"Day"===O?a.setDate(a.getDate()+t):"Week"===O?a.setDate(a.getDate()+7*t):"Month"===O&&a.setMonth(a.getMonth()+t),G(t),q(a);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Y=function(e){W(e),setTimeout(function(){_(!1)},300)};return e(function(){z()},[o,d,O]),t.createElement(t.Fragment,null,t.createElement(E,{classname:"start",style:{overflow:k?"hidden":"auto"}},t.createElement("div",{className:"header"},t.createElement("div",{className:"back"},t.createElement(n,{to:"/goals"},t.createElement(S,null))),t.createElement("h5",null,"Target ",t.createElement("br",null),"& Duration")),t.createElement("div",null,t.createElement("form",{onSubmit:function(e){e.preventDefault();var t=e.target.target.value,a=e.target.amount.value,n=e.target.plan.value,r="/goals?target=".concat(t,"&amount=").concat(a,"&plan=").concat(n,"#/add/target/details");return setTimeout(function(){return l(r)},500)},className:"borderless"},t.createElement(f,{name:"plan",defaultValue:O}),t.createElement(g,null,t.createElement("h4",null,"Target Amount"),t.createElement("div",null,"¢",v({defaultValue:"0",onChange:function(e){return m(Number(e.target.value))},className:"target",name:"target",autoFocus:!0}))),t.createElement(g,{className:"save"},t.createElement("div",null,t.createElement("h4",null,"Amount to save"),t.createElement("div",null,"¢",v({defaultValue:"0",name:"amount",onChange:function(e){y(Number(e.target.value))},disabled:!!k}))),t.createElement("span",null,"/"),t.createElement("div",null,t.createElement("div",{className:"dropdown",onClick:function(){_(!0)}},t.createElement("div",null,O),t.createElement(w,null)),t.createElement("h4",null))),t.createElement(g,{className:"estimate"},!isNaN(I)&&t.createElement("div",{className:"appear"},t.createElement("h4",null,"From"),t.createElement("h5",null,H(P)),t.createElement("h4",null,"To"),t.createElement("h5",null,H(I))),t.createElement("div",{className:"period"},t.createElement("h3",null,isFinite(A)?A:0,t.createElement("span",null,"".concat(O,"s"))))),t.createElement(g,null,t.createElement(h,null,"Next"))))),k&&t.createElement(p,{onClick:_},t.createElement(F,{onClick:function(){return Y("Day")}},t.createElement("li",null,"Day"),"Day"==O&&t.createElement(D,null)),t.createElement(F,{onClick:function(){return Y("Week")}},t.createElement("li",null,"Week"),"Week"==O&&t.createElement(D,null)),t.createElement(F,{onClick:function(){return Y("Month")}},t.createElement("li",null,"Month"),"Month"==O&&t.createElement(D,null))))},q=s()(function(e){var s=e.target,d=e.amount,p=e.plan,v=e.dispatch,b=a(),w=r(b,2),D=w[0],C=w[1],T=a(""),k=r(T,2),F=k[0],j=k[1],L=a("default.jpeg"),V=r(L,2),U=V[0],x=V[1],O=a(!1),W=r(O,2),M=W[0],R=W[1],I=a([]),q=r(I,2),B=q[0],P=q[1],H=function(e){if(e.target.files[0])return R(!0),C(URL.createObjectURL(e.target.files[0])),u(e).then(function(e){j(e),x(e.name)})},z=function(){var e=new FormData(document.querySelector("#goal"));e.append("shared",B.length>0),e.append("users",JSON.stringify({user:B}));var t=new FormData;return t.append("category","goals"),t.append("file",F),_(m.addGoal,e).then(function(t){v({type:i.SET_GOAL,payload:o(e)}),l("/goals?uid=".concat(t.uid,"#/goal"))}).then(function(){return M&&_(m.uploadImage,t)})};return t.createElement(t.Fragment,null,t.createElement(E,{classname:"start"},t.createElement("div",{className:"header"},t.createElement("div",{className:"back"},t.createElement(n,{to:"#/add/target"},t.createElement(S,null))),t.createElement("h5",null,"Goal ",t.createElement("br",null),"Details")),t.createElement("div",null,t.createElement("form",{className:"borderless",onSubmit:function(e){return e.preventDefault(),setTimeout(function(){return v({type:i.SET_SCHEDULE,payload:{status:!0,handleForm:function(){return z()}}})},500)},id:"goal"},f({name:"blob",defaultValue:M}),f({name:"saved",defaultValue:0}),f({name:"file",defaultValue:U}),f({name:"picture",defaultValue:D}),f({name:"target",defaultValue:s}),f({name:"amount",defaultValue:d}),f({name:"plan",defaultValue:p}),D&&t.createElement("div",{className:"file"},t.createElement("div",{id:"picture",style:{backgroundImage:M?"url(".concat(D,")"):"url(https://triva.s3.eu-west-2.amazonaws.com/profile/outline.png)"}}),y({onChange:function(e){H(e)}})),t.createElement(g,null,t.createElement("h4",null,"Goal"),t.createElement("div",null,N({name:"goal",placeholder:"Travel Ghana",required:!0,autoFocus:!0}))),t.createElement("div",{className:"file"},t.createElement("a",null,"Upload photo"),y({onChange:function(e){H(e)}})),t.createElement("p",null,"What does your goal look like, add a picture."),t.createElement(g,null,t.createElement("h4",null,"Share Goal"),t.createElement("div",{className:"list"},t.createElement("div",null,t.createElement("li",null,"You"),t.createElement("div",null)),B.map(function(e,a){return t.createElement("div",{key:a},t.createElement("li",null,e),t.createElement(A,{onClick:function(){return function(e){var t=c(B);-1!==e&&(t.splice(e,1),P(c(t)))}(a)}}))}),t.createElement("div",null,N({name:"newUser",placeholder:"Email"}),t.createElement(G,{onClick:function(){return e=document.querySelector("input[name=newUser]").value,P([].concat(c(B),[e])),void(document.querySelector("input[name=newUser]").value="");var e}})))),t.createElement(g,null,t.createElement(h,null,"start"))))))}),B=s(function(e){return{goals:e.goals}})(function(a){var r=a.goals,c=a.dispatch;d(a,["goals","dispatch"]);e(function(){_(m.getGoals).then(function(e){return c({type:i.SET_GOALS,payload:e})})},[]);return t.createElement(M,null,t.createElement("div",{className:"goals"},t.createElement("div",{className:"header"},r.length>0&&t.createElement("div",null,t.createElement("a",{onClick:function(){return l("#/summary")}},"Summary"),t.createElement("a",{className:"plus",onClick:function(){return l("#/add/target")}},t.createElement(G,null))),t.createElement("div",null,t.createElement("h2",null,"Goals"))),t.createElement("div",{className:"list"},function(e){if(e)return e.map(function(e,a){return t.createElement(n,{to:"/goals?uid=".concat(e.uid,"#/goal"),onClick:function(){return c({type:i.SET_GOAL,payload:e})},key:a,className:"item"},t.createElement("div",{className:"bg",style:{backgroundImage:"url(https://s3.eu-west-2.amazonaws.com/triva/goals/".concat(e.picture,")")}}),t.createElement("div",{className:"desc"},t.createElement("h5",null,e.goal),t.createElement("h6",null,"¢",e.saved," ",t.createElement("span",null,"saved"))))})}(r))))}),P=s(function(e){return{goal:e.goal,goalTransactions:e.goalTransactions}})(function(a){var l=a.goal,r=a.goalTransactions,c=a.dispatch,u=a.uid,o=U(),s=o.getDate,d=o.getWeekDay;e(function(){if("true"!==l.blob){var e=new FormData;e.append("uid",u),_(m.getGoal,e).then(function(e){return c({type:i.SET_GOAL,payload:e})}),_(m.getGoalTransactions,e).then(function(e){return c({type:i.SET_GOAL_TRANSACTIONS,payload:e})})}},[]);return t.createElement("div",{className:"goal"},t.createElement("div",{className:"bg",style:{backgroundImage:"true"==l.blob?"url(".concat(l.picture,")"):"url(https://s3.eu-west-2.amazonaws.com/triva/goals/".concat(l.picture,")")}},t.createElement("div",{className:"cover"},t.createElement("section",{className:"head"},t.createElement(n,{to:"/goals"},t.createElement(S,null)),t.createElement(n,{to:"?uid=".concat(u,"#/goal/edit")},t.createElement(C,null))))),t.createElement("div",{className:"details"},t.createElement("div",{className:"desc"},t.createElement("div",null,t.createElement("h3",null,l.goal||""),t.createElement("h6",null,"¢",l.target)),t.createElement(T,{percent:Number(l.saved/l.target*100).toFixed(1),amount:l.target})),t.createElement("div",{className:"amount"},t.createElement(n,{to:"?uid=".concat(u,"#/goal/fund")},t.createElement(G,null)),t.createElement("div",null,t.createElement("h2",null,"¢",j(l.saved)||""),t.createElement("span",null,"saved")),t.createElement(n,{to:"?uid=".concat(u,"#/goal/withdraw")},t.createElement(A,null))),t.createElement("div",{className:"list"},function(e){if(e)return e.map(function(e,a){return t.createElement("div",{className:"item",key:a},t.createElement("div",null,t.createElement("li",null,d(e.created)+" "+s(e.created)),t.createElement("span",null,"credit"===e.transaction_activity?"Added Cash":"Withdrawal"," ")),t.createElement("div",null,t.createElement("span",null,"credit"===e.transaction_activity?"+":"-","¢",e.amount)))})}(r))))}),H=s(function(e){return{balance:e.balance}})(function(a){var c=a.balance,u=a.uid,o=a.dispatch,s=x(c.balance,"debit"),d=r(s,2),p=d[0],h=d[1];e(function(){var e=new FormData;e.append("uid",u),_(m.getGoal,e).then(function(e){return o({type:i.SET_GOAL,payload:e})}).then(function(){return _(m.getBalance).then(function(e){return o({type:i.SET_BALANCE,payload:e})})})},[]);return t.createElement(E,null,t.createElement("div",{className:"header"},t.createElement(n,{to:"?uid=".concat(u,"#/goal"),className:"exit"},"Cancel"),t.createElement("h6",null,"¢",p+" "," ",t.createElement("span",null,"Bal"))),t.createElement("div",null,t.createElement("form",{onSubmit:function(e){e.preventDefault();var t=document.querySelector("form"),a=new FormData(t);return t.reset(),_(m.addFunds,a).then(function(){o({type:i.WITHDRAW_BALANCE,payload:a.get("amount")}),o({type:i.FUND_GOAL,payload:a.get("amount")}),l("?uid=".concat(u,"#/goal"))})}},f({name:"uid",defaultValue:u}),t.createElement(g,{id:"amount"},v({name:"amount",onChange:function(e){return h(e.target.value)},defaultValue:"0.00"}),"GHS"),t.createElement(g,null,t.createElement(b,null,"Add Funds")))))}),z=s(function(e){return{goal:e.goal}})(function(c){var u=c.goal,o=c.uid,s=c.dispatch,d=x(u.saved,!1),p=r(d,2),h=p[0],y=p[1],N=a(!0),S=r(N,2),w=S[0],D=S[1];e(function(){var e=new FormData;e.append("uid",o),_(m.getGoal,e).then(function(e){return s({type:i.SET_GOAL,payload:e})}).then(function(){return _(m.getBalance).then(function(e){return s({type:i.SET_BALANCE,payload:e})})})},[]),e(function(){D(u.taget-u.saved==0)},[u]);return t.createElement(E,null,t.createElement("div",{className:"header"},t.createElement(n,{to:"?uid=".concat(o,"#/goal"),className:"exit"},"Cancel"),t.createElement("h6",null,w?t.createElement(t.Fragment,null,"¢",h+" "," ",t.createElement("span",null,"Saved")):null)),t.createElement("div",null,w?t.createElement("form",{onSubmit:function(e){if(e.preventDefault(),!(Number(u.saved)<Number(e.target.amount.value))){var t=document.querySelector("form"),a=new FormData(t);return t.reset(),_(m.withdrawFunds,a).then(function(){s({type:i.WITHDRAW_GOAL,payload:a.get("amount")}),l("?uid=".concat(o,"#/goal"))})}O("Amount exceeds saved amount")}},f({name:"uid",defaultValue:o}),t.createElement(g,{id:"amount"},v({name:"amount",onChange:function(e){return y(e.target.value)},defaultValue:"0.00"}),"GHS"),t.createElement(g,null,t.createElement(b,null,"Withdraw"))):t.createElement("div",null,t.createElement("h5",null,"Your goal is yet to be achieved, withdrawing now with come with a",t.createElement("b",null," 3%")," charge."),t.createElement("button",{onClick:function(){return D(!w)}},"Proceed"))))}),Y=s(function(e){return{goal:e.goal,goalUsers:e.goalUsers}})(function(s){var d=s.goal,p=s.goalUsers,h=s.dispatch,S=s.uid,w=a(d.picture),D=r(w,2),C=D[0],T=D[1],F=a(""),j=r(F,2),L=j[0],V=j[1],U=a(d.picture),x=r(U,2),O=x[0],W=x[1],M=a(!1),R=r(M,2),I=R[0],q=R[1],B=a([]),P=r(B,2),H=P[0],z=P[1];e(function(){var e=new FormData;e.append("uid",S),_(m.getGoal,e).then(function(e){return h({type:i.SET_GOAL,payload:e})}).then(function(){return _(m.getSharedUsers,e).then(function(e){return h({type:i.SET_GOAL_USERS,payload:e})})})},[]),e(function(){z(p)},[p]);return t.createElement(t.Fragment,null,t.createElement(E,{classname:"goal start"},t.createElement("div",{className:"header"},t.createElement("span",null),t.createElement(n,{to:"?uid=".concat(S,"#/goal"),className:"exit"},"Cancel")),t.createElement("div",{className:"file"},t.createElement("div",{id:"picture",style:{backgroundImage:I?"url(".concat(C,")"):"url(https://s3.eu-west-2.amazonaws.com/triva/goals/".concat(d.picture,")")}},t.createElement("div",{className:"cover"},t.createElement(y,{onChange:function(e){!function(e){e.target.files[0]&&(q(!0),T(URL.createObjectURL(e.target.files[0])),u(e).then(function(e){V(e),W(e.name)}))}(e)}}),t.createElement(k,null)))),t.createElement("section",{className:"form"},t.createElement("form",{className:"borderless",onSubmit:function(e){e.preventDefault();var t=new FormData(document.querySelector("form"));t.append("shared",H.length>0),t.append("users",JSON.stringify({user:H}));var a=new FormData;return a.append("category","goals"),a.append("file",L),_(m.updateGoal,t).then(function(e){h({type:i.SET_GOAL,payload:o(t)}),l("?uid=".concat(S,"#/goal"))}).then(function(){return I&&_(m.uploadImage,a)})}},f({name:"uid",defaultValue:d.uid}),f({name:"blob",defaultValue:I}),f({name:"saved",defaultValue:d.saved}),f({name:"file",defaultValue:O}),f({name:"picture",defaultValue:C}),t.createElement(g,null,t.createElement("h4",null,"What's your Goal"),N({name:"goal",defaultValue:d.goal})),t.createElement(g,null,t.createElement("h4",null,"Target"),v({name:"target",defaultValue:d.target})),t.createElement(g,null,t.createElement("h4",null,"Share Goal"),t.createElement("div",{className:"list"},t.createElement("div",null,t.createElement("li",null,"You"),t.createElement("div",null)),H.map(function(e,a){return t.createElement("div",{key:a},t.createElement("li",null,e.username),t.createElement(A,{onClick:function(){return function(e){var t=c(H);-1!==e&&(t.splice(e,1),z(c(t)))}(a)}}))}),t.createElement("div",null,t.createElement(N,{autoFocus:!0,name:"newUser",placeholder:"Email"}),t.createElement(G,{onClick:function(){return e=document.querySelector("input[name=newUser]").value,z([].concat(c(H),[e])),void(document.querySelector("input[name=newUser]").value="");var e}})))),t.createElement(g,null,t.createElement(b,null,"Update Goal")),t.createElement(g,null,t.createElement(n,{to:"?uid=".concat(S,"#/goal/edit/delete"),className:"del"},"Delete"))))))}),J=s(function(e){return{goal:e.goal}})(function(a){var r=a.goal,c=a.dispatch,u=a.uid;return e(function(){var e=new FormData;e.append("uid",u),_(m.getGoal,e).then(function(e){return c({type:i.SET_GOAL,payload:e})})},[]),t.createElement(E,null,t.createElement("div",{className:"header"},t.createElement(n,{to:"?uid=".concat(u,"#/goal/edit"),className:"exit"},"Cancel"),t.createElement("h5",null)),t.createElement("div",null,t.createElement("h5",null,"Delete ",r.goal,","),t.createElement("p",{style:{fontSize:"20px",fontWeight:"300"}},"All funds accumulated will be moved to your triva account balance, with a charge of 3% of goal non completion.")),t.createElement("div",null,t.createElement("button",{onClick:function(){return(e=new FormData).append("uid",u),_(m.deleteGoal,e).then(function(){return l("/goals")});var e}},"Delete Goal")))});export default function(e){return t.createElement(t.Fragment,null,t.createElement(W,{location:e.location},t.createElement(R,{path:"#/summary",up:!0}),t.createElement(I,{path:"#/add/target",left:!0}),t.createElement(q,{path:"#/add/target/details",left:!0}),t.createElement(P,{path:"#/goal",left:!0}),t.createElement(H,{path:"#/goal/fund",up:!0}),t.createElement(z,{path:"#/goal/withdraw",up:!0}),t.createElement(Y,{path:"#/goal/edit",up:!0}),t.createElement(J,{path:"#/goal/edit/delete",up:!0})),t.createElement(B,null))}
